<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tasgheel POS System</title>
  <link rel="stylesheet" href="css/styles.css">
  <style>
    .modal {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center;
    }
    .modal-content {
      background: #fff; padding: 20px; border-radius: 8px; width: 300px;
      box-shadow: 0 0 10px rgba(0,0,0,0.3); text-align: center;
    }
    .cart-item button {
      margin-left: 10px;
      padding: 4px 6px;
      font-size: 0.9em;
      cursor: pointer;
    }
  </style>
</head>
<body>

<!-- License Check -->
<div id="licenseCheckOverlay" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:#000000e6;z-index:10000;color:white;text-align:center;padding-top:150px;">
  <h2>ğŸ”’ Access Denied</h2>
  <p>This system requires a valid license to operate.</p>
  <button onclick="window.location.href='index.html'" class="btn btn-primary" style="margin-top: 20px;">Go to Activation</button>
</div>

<!-- Language Switcher -->
<div class="language-switcher">
  <button class="lang-btn" onclick="setLanguage('en')" id="langEn">English</button>
  <button class="lang-btn" onclick="setLanguage('ar')" id="langAr">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
</div>

<div class="app">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <h2 id="posSystemTitle">ğŸªTasgheel POS System</h2>
      <p id="licensedVersion">Enhanced Edition</p>
    </div>
      <nav>
        <a href="pos.html" class="nav-item active" data-i18n="nav_pos">ğŸ›’ Point of Sale</a>
        <a href="products.html" class="nav-item" data-i18n="nav_products">ğŸ“¦ Products</a>
        <a href="receipts.html" class="nav-item" data-i18n="nav_receipts">ğŸ§¾ Receipts</a>
        <a href="reports.html" class="nav-item" data-i18n="nav_reports">ğŸ“ˆ Reports</a>
	<a href="salesmen.html" class="nav-item" data-i18n="nav_salesmen">ğŸ§‘â€ğŸ’¼ Salesmen</a>
	<a href="expenses.html" class="nav-item" data-i18n="nav_Expenses">ğŸ“‹ Expenses</a>

        <a href="admin.html" class="nav-item"  data-i18n="nav_admin">âš™ï¸ Admin Panel</a>
	<a href="backup.html" class="nav-item" data-i18n="nav_backup">ğŸ’¾ BackUP</a>
      </nav>

    <div class="sidebar-footer">
      <button class="btn btn-danger" onclick="confirmLogout()" id="logoutBtn">Logout</button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <header class="top-bar">
      <h1 id="pageTitle">Point of Sale</h1>
      <div style="display:flex;align-items:center;gap:10px;">
        <span id="welcomeText">Welcome,</span>
        <span id="currentUserName">User</span>
        <span id="userRole" class="user-role">cashier</span>
        <span style="background:#27ae60;color:white;padding:4px 8px;border-radius:12px;font-size:0.7rem;">ğŸ” Licensed</span>
      </div>
    </header>

    <section class="content-area">
      <div class="pos-layout">
        <!-- Products Section -->
        <div>
          <div class="card">
            <div class="card-header">
              <span id="productsTitle">Products</span>
              <div style="display:flex;gap:10px;align-items:center;">
                <input type="text" id="productSearch" placeholder="Search by name, code, or barcode..." class="search-box" style="width:200px;">
                <button class="btn btn-secondary" onclick="scanBarcode()" id="scanBtn">ğŸ“· Scan</button>
              </div>
            </div>
            <div class="card-body">
              <div class="product-grid" id="productGrid">
                <div style="text-align:center;padding:40px;color:#666;">
                  <p id="loadingText">Loading products...</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Cart Section -->
        <div class="cart">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
            <h3 id="cartTitle">ğŸ›’ Cart</h3>
            <span id="cartCounter" class="badge">0</span>
          </div>

          <div id="cartItems">
            <p id="cartEmptyText" style="text-align:center;color:#666;">Cart is empty</p>
          </div>

          <div class="cart-summary">
            <div><span id="subtotalLabel">Subtotal:</span> <span id="cartSubtotal">0.00 Ø¬.Ù…</span></div>
            <div><span id="discountLabel">Discount:</span> <span id="cartDiscount">0.00 Ø¬.Ù…</span></div>
            <div><span id="taxLabel">Tax (0%):</span> <span id="cartTax">0.00 Ø¬.Ù…</span></div>
            <hr>
            <div class="cart-total" id="cartTotal">Total: 0.00 Ø¬.Ù…</div>
          </div>

          <div style="margin-bottom:10px;">
            <label for="salesmanSelect">ğŸ‘¤ <span id="salesmanLabel">Salesman:</span></label>
            <select id="salesmanSelect" style="width:100%;padding:6px;margin-top:5px;"></select>
          </div>

          <div class="payment-methods">
            <button class="btn btn-success" onclick="processSale('cash')" id="cashBtn" disabled>ğŸ’µ Cash</button>
            <button class="btn btn-success" onclick="processSale('card')" id="cardBtn" disabled>ğŸ’³ Card</button>
            <button class="btn btn-success" onclick="processSale('mobile')" id="mobileBtn" disabled>ğŸ“± Mobile</button>
          </div>

          <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px;">
            <button class="btn btn-warning" onclick="holdTransaction()" id="holdBtn" disabled>â¸ï¸ Hold</button>
            <button class="btn btn-secondary" onclick="clearCart()" id="clearCartBtn" disabled>ğŸ—‘ï¸ Clear</button>
          </div>

          <button class="btn btn-info" onclick="closeDay()" style="margin-top:10px;width:100%;">ğŸ§¾ <span id="closeDayBtn">Close Day</span></button>
        </div>
      </div>
    </section>
  </main>
</div>

<!-- Close Day Modal -->
<div id="closeDayModal" class="modal" style="display:none;">
  <div class="modal-content" style="width:400px;">
    <h3 id="daySummaryTitle">ğŸ“Š Day Summary</h3>
    <div id="daySummaryContent" style="text-align:left;margin-top:10px;"></div>
    <br>
    <button onclick="window.print()" class="btn btn-primary">ğŸ–¨ï¸ <span id="printBtn">Print</span></button>
    <button onclick="document.getElementById('closeDayModal').style.display='none'" class="btn btn-danger">âœ–ï¸ <span id="cancelBtn">Close</span></button>
  </div>
</div>

<!-- Discount Modal -->
<div id="discountModal" class="modal" style="display:none;">
  <div class="modal-content">
    <h3 id="discountTitle">ğŸ§¾ Ø®ØµÙ…</h3>
    <label>Ù†ÙˆØ¹ Ø§Ù„Ø®ØµÙ…:</label>
    <select id="discountType">
      <option value="none">Ù„Ø§ ÙŠÙˆØ¬Ø¯</option>
      <option value="percent">Ù†Ø³Ø¨Ø© Ù…Ø¦ÙˆÙŠØ© (%)</option>
      <option value="value">Ù‚ÙŠÙ…Ø© Ø«Ø§Ø¨ØªØ© (Ø¬.Ù…)</option>
    </select>
    <br><br>
    <label>Ø§Ù„Ù‚ÙŠÙ…Ø©:</label>
    <input type="number" id="discountValue" placeholder="0">
    <br><br>
    <button onclick="saveDiscount()">ğŸ’¾ Ø­ÙØ¸</button>
    <button onclick="closeDiscountModal()">âœ–ï¸ Ø¥Ù„ØºØ§Ø¡</button>
  </div>
</div>

<!-- Footer -->
  <footer class="footer">
    Tashgheel POSÂ© 2025</strong> |
    <a href="tel:+201126522373">+201126522373 / +201155253886</a>
 	<span id="footerText">Designed and developed by itqan</span>
  </footer>

<!-- Scripts -->
<script src="js/auth.js"></script>
<script src="js/backup-system.js"></script>
<script src="js/pos-app.js"></script>

<!-- Translations -->
<script>
  const translations = {
    en: {
      posSystemTitle: "ğŸª POS System",
      licensedVersion: "Enhanced Edition",
      pageTitle: "Point of Sale",
      welcomeText: "Welcome,",
      logoutBtn: "Logout",
      backupBtn: "ğŸ’¾ Backup",
      productsTitle: "Products",
      scanBtn: "ğŸ“· Scan",
      cartTitle: "ğŸ›’ Cart",
      cartEmptyText: "Cart is empty",
      subtotalLabel: "Subtotal:",
      discountLabel: "Discount:",
      taxLabel: "Tax (0%):",
      cashBtn: "ğŸ’µ Cash",
      cardBtn: "ğŸ’³ Card",
      mobileBtn: "ğŸ“± Mobile",
      holdBtn: "â¸ï¸ Hold",



      clearCartBtn: "ğŸ—‘ï¸ Clear",
      discountTitle: "ğŸ§¾ Discount",
      closeDayBtn: "Close Day",
      daySummaryTitle: "ğŸ“Š Day Summary",
      printBtn: "Print",
      cancelBtn: "Close",
      salesmanLabel: "Salesman:",
      footerText: "Designed and developed by itqan",

      nav_pos: "ğŸ›’ Point of Sale",
      nav_products: "ğŸ“¦ Products",
      nav_receipts: "ğŸ§¾ Receipts",
      nav_reports: "ğŸ“ˆ Reports",
      nav_salesmen: "ğŸ§‘â€ğŸ’¼ Salesmen",
      nav_Expenses: "ğŸ“‹ Expenses",
      nav_admin: "âš™ï¸ Admin Panel",
nav_backup: "ğŸ’¾ Backup"

    },
    ar: {
      posSystemTitle: "ğŸª Ù†Ø¸Ø§Ù… Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ¹",
      licensedVersion: "Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø­Ø³Ù†",
      pageTitle: "Ø´Ø§Ø´Ø© Ø§Ù„Ø¨ÙŠØ¹",
      welcomeText: "Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ",
      logoutBtn: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",
      backupBtn: "ğŸ’¾ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ",
      productsTitle: "Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",
      scanBtn: "ğŸ“· Ù…Ø³Ø­",
      cartTitle: "ğŸ›’ Ø§Ù„Ø³Ù„Ø©",
      cartEmptyText: "Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©",
      subtotalLabel: "Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ±Ø¹ÙŠ:",
      discountLabel: "Ø§Ù„Ø®ØµÙ…:",
      taxLabel: "Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© (Ù Ùª):",
      cashBtn: "ğŸ’µ Ù†Ù‚Ø¯ÙŠ",
      cardBtn: "ğŸ’³ Ø¨Ø·Ø§Ù‚Ø©",
      mobileBtn: "ğŸ“± Ù…ÙˆØ¨Ø§ÙŠÙ„",
      holdBtn: "â¸ï¸ ØªØ¹Ù„ÙŠÙ‚",
      clearCartBtn: "ğŸ—‘ï¸ Ù…Ø³Ø­",
      discountTitle: "ğŸ§¾ Ø®ØµÙ…",
      closeDayBtn: "Ø¥Ù‚ÙØ§Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©",
      daySummaryTitle: "ğŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„ÙŠÙˆÙ…",
      printBtn: "Ø·Ø¨Ø§Ø¹Ø©",
      cancelBtn: "Ø¥ØºÙ„Ø§Ù‚",
      salesmanLabel: "Ø§Ù„Ø¨Ø§Ø¦Ø¹:",
      footerText: "ØªÙ… Ø§Ù„ØªØµÙ…ÙŠÙ… ÙˆØ§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© itqan",

    nav_pos: "ğŸ›’ Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹",
      nav_products: "ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",
      nav_receipts: "ğŸ§¾ Ø§Ù„ÙÙˆØ§ØªÙŠØ±",
      nav_reports: "ğŸ“ˆ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±",
      nav_salesmen: "ğŸ§‘â€ğŸ’¼ Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙˆÙ†",
      nav_Expenses: "ğŸ“‹ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ",
      nav_admin: "âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…",
nav_backup: "ğŸ’¾ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ"

    }
  };

  function setLanguage(lang) {
    localStorage.setItem('pos_language', lang);
    applyTranslations();
  }

 function applyTranslations() {
  const lang = localStorage.getItem('pos_language') || 'en';
  const t = translations[lang];

  // 1. ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø­Ø³Ø¨ ID
  for (const key in t) {
    const el = document.getElementById(key);
    if (el) el.textContent = t[key];
  }

  // 2. ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù„ÙŠ Ø¹Ù†Ø¯Ù‡Ø§ data-i18n
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (t[key]) el.textContent = t[key];
  });

  // 3. Ø¶Ø¨Ø· Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµÙØ­Ø©
  const isRTL = lang === 'ar';
  document.documentElement.setAttribute("dir", isRTL ? 'rtl' : 'ltr');
  document.documentElement.setAttribute("lang", lang);

  // 4. Ø¶Ø¨Ø· Ø§ØªØ¬Ø§Ù‡ Ø¨Ø¹Ø¶ Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙŠØ¯ÙˆÙŠÙ‹Ø§
  document.querySelectorAll('.card-header, .top-bar, .modal-content, .cart-summary, .sidebar, .pos-layout, label, input, select, textarea').forEach(el => {
    el.style.textAlign = isRTL ? 'right' : 'left';
  });

  // 5. Ø¹ÙƒØ³ Ø§ØªØ¬Ø§Ù‡ Flex layout Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯
  document.querySelectorAll('[style*="display:flex"]').forEach(el => {
    el.style.flexDirection = isRTL ? 'row-reverse' : 'row';
  });


}


  document.addEventListener('DOMContentLoaded', applyTranslations);
</script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    loadProducts();
  });
</script>
</body>
</html>
